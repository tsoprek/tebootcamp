{% extends 'base.html' %}

{% block head %}
<div class="panel panel--dark">
    <h1 class="display-3 flex flex-center" style="margin-top: 75px;"></h1>
</div>
<div class="row base-margin-top flex flex-center">
    <div class="col-md-6">
        <div class="steps">
            <div class="step visited">
                <div class="step__icon">
                    <span class="icon-check"></span>
                </div>
                <div class="step__label">Instructions</div>
            </div>
            <div class="step visited">
                <span class="step__icon">1</span>
                <div class="step__label">TASK 1</div>
            </div>
            <div class="step visited">
                <div class="step__icon">2</div>
                <div class="step__label">TASK 2</div>
            </div>
            <div class="step visited">
                <div class="step__icon">3</div>
                <div class="step__label">TASK 3</div>
            </div>
            <div class="step visited">
                <div class="step__icon">4</div>
                <div class="step__label">TASK 4</div>
            </div>
            <div class="step active">
                <div class="step__icon">5</div>
                <div class="step__label">TASK 5</div>
            </div>
            <div class="step">
                <div class="step__icon">6</div>
                <div class="step__label">TASK 6</div>
            </div>
            <div class="step">
                <div class="step__icon">END</div>
                <div class="step__label">TASK 7</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block body%}
    <div class="row">
    <div class="col-md-2">
        <ul id="vleft" class="tabs tabs--vertical">
            <li id="vleft-1" class="tab">
                <a tabindex="0" href="/">INSTRUCTIONS</a>
            </li>
            <li id="vleft-2" class="tab">
                <a tabindex="0" href="/task1">TASK 1</a>
            </li>
            <li id="vleft-3" class="tab">
                <a tabindex="0" href="/task2">TASK 2</a>
            </li>
            <li id="vleft-4" class="tab">
                <a tabindex="0" href="/task3">TASK 3</a>
            </li>
            <li id="vleft-5" class="tab">
                <a tabindex="0" href="/task4">TASK 4</a>
            </li>
            <li id="vleft-6" class="tab">
                <a tabindex="0" href="/task5">TASK 5</a>
            </li>
            <li id="vleft-7" class="tab">
                <a tabindex="0" href="/task6">TASK 6</a>
            </li>
            <li id="vleft-8" class="tab">
                <a tabindex="0" href="/task7">TASK 7</a>
            </li>
            <li id="vleft-9" class="tab active">
                <a tabindex="0" href="/task8">TASK 8</a>
            </li>
            <li id="vleft-10" class="tab">
                <a tabindex="0" href="/task9">TASK 9</a>
            </li>
            <li id="vleft-11" class="tab">
                <a tabindex="0" href="/task10">TASK 10</a>
            </li>
            <li id="vleft-12" class="tab">
                <a tabindex="0">SOLUTIONS</a>
            </li>
        </ul>
    </div>
    <div class="col-md-9">
        <div id="vleft-content" class="tab-content">
            <div id="vleft-1-content" class="tab-pane">
                <p>INSTRUCTIONS</p>
            </div>
            <div id="vleft-2-content" class="tab-pane">
                <p>TASK 1</p>
            </div>
            <div id="vleft-3-content" class="tab-pane">
                <p>TASK 2</p>
            </div>
            <div id="vleft-4-content" class="tab-pane">
                <p>TASK 3</p>
            <div id="vleft-5-content" class="tab-pane">
                <p>TASK 4</p>
            <div id="vleft-6-content" class="tab-pane">
                <p>TASK 5</p>
            </div>
            <div id="vleft-7-content" class="tab-pane">
                <p>TASK 6</p>
            </div>
            <div id="vleft-8-content" class="tab-pane">
                <p>TASK 7</p>
            </div>
            <div id="vleft-9-content" class="tab-pane active">
                <p class="text-size-28 text-weight-300">TASK 8</p>
            </div>
            <div id="vleft-10-content" class="tab-pane">
                <p>TASK 9</p>
            </div>
            <div id="vleft-11-content" class="tab-pane">
                <p>TASK 10</p>
            </div>
            <div id="vleft-12-content" class="tab-pane">
                <p>SOLUTIONS</p>
            </div>
        </div>
    </div>
</div>
<body class="cui" data-theme="dark">
<h4 class="text-size-28 text-weight-300 panel panel--dark">Agent UI Issues</h4>
    <p class="text-size-18 text-weight-400 base-margin-top text-justify">
        Clicking on details, give us more information about what is wrong with SSL certificate.
        It is pointing to missing Root certificate.<br>
    </p>
    <img src="/static/SSL_cert_error.png" alt="SSL Certificate Error">
    <p class="text-size-18 text-weight-400 base-margin-top text-justify">
        We can get certificate in many ways; from browser, from certificate authority page, openssl command, etc.
        It is up to you how you want to download certificate. Let's first confirm that our certificate is not in the store.
        I used openssl s_client command to get all certificates and did a grep for CN filed.
        This is the name that we expect in our certificate store.<br>

        As per below output we have 7 certificates that are for GlobaSign, so let's help our self with a script to pars
        trough them and get CN filed for each of these.
    </p>
    <pre>

        $ openssl s_client -connect google.com:443 | grep "CN = "
        depth=2 C = US, O = Google Trust Services LLC, CN = GTS Root R1
        verify error:num=20:unable to get local issuer certificate
        verify return:1
        depth=1 C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
        verify return:1
        depth=0 CN = *.google.com
        verify return:1
         0 s:CN = *.google.com
           i:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
         1 s:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
           i:C = US, O = Google Trust Services LLC, CN = GTS Root R1
         2 s:C = US, O = Google Trust Services LLC, CN = GTS Root R1
        <span style="color: green">i:C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA</span>
        subject=CN = *.google.com
        issuer=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3

        $ cd /usr/share/ca-certificates/mozilla
        $ ls | grep -i globalsign | wc -l
        7
        $ ls | grep -i globalsign
        GlobalSign_ECC_Root_CA_-_R4.crt
        GlobalSign_ECC_Root_CA_-_R5.crt
        GlobalSign_Root_CA_-_R2.crt
        GlobalSign_Root_CA_-_R3.crt
        GlobalSign_Root_CA_-_R6.crt
        GlobalSign_Root_E46.crt
        GlobalSign_Root_R46.crt

        $ ls | grep -i globalsign | while read  certificate; do openssl x509 -text -in $certificate; done | grep "CN = "
        Issuer: OU = GlobalSign ECC Root CA - R4, O = GlobalSign, CN = GlobalSign
        Subject: OU = GlobalSign ECC Root CA - R4, O = GlobalSign, CN = GlobalSign
        Issuer: OU = GlobalSign ECC Root CA - R5, O = GlobalSign, CN = GlobalSign
        Subject: OU = GlobalSign ECC Root CA - R5, O = GlobalSign, CN = GlobalSign
        Issuer: OU = GlobalSign Root CA - R2, O = GlobalSign, CN = GlobalSign
        Subject: OU = GlobalSign Root CA - R2, O = GlobalSign, CN = GlobalSign
        Issuer: OU = GlobalSign Root CA - R3, O = GlobalSign, CN = GlobalSign
        Subject: OU = GlobalSign Root CA - R3, O = GlobalSign, CN = GlobalSign
        Issuer: OU = GlobalSign Root CA - R6, O = GlobalSign, CN = GlobalSign
        Subject: OU = GlobalSign Root CA - R6, O = GlobalSign, CN = GlobalSign
        Issuer: C = BE, O = GlobalSign nv-sa, CN = GlobalSign Root E46
        Subject: C = BE, O = GlobalSign nv-sa, CN = GlobalSign Root E46
        Issuer: C = BE, O = GlobalSign nv-sa, CN = GlobalSign Root R46
        Subject: C = BE, O = GlobalSign nv-sa, CN = GlobalSign Root R46

        # Let's filter this output to GTS Root R1 as we expect subject to GTS Root R1
        $ ls | grep -i globalsign | while read  certificate; do openssl x509 -text -in $certificate; done | grep 'GTS Root R1'
        $ ls | grep -i globalsign | while read  certificate; do openssl x509 -text -in $certificate; done | grep 'GTS Root R1' | wc -l
        0
    </pre>


    <div class="row">
        <div class="col-md-12">
            <button class="btn btn--danger--right" ><a style="color: black" href="/task9">TASK 9</a></button>
        </div>
    </div><br>
</body>
{% endblock %}