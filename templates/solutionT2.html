{% extends 'base.html' %}

{% block head %}
<div class="panel panel--dark">
    <h1 class="display-3 flex flex-center" style="margin-top: 75px;"></h1>
</div>
<div class="row base-margin-top flex flex-center">
    <div class="col-md-6">
        <div class="steps">
            <div class="step visited">
                <div class="step__icon">
                    <span class="icon-check"></span>
                </div>
                <div class="step__label">Instructions</div>
            </div>
            <div class="step visited">
                <span class="step__icon">1</span>
                <div class="step__label">TASK 1</div>
            </div>
            <div class="step active">
                <div class="step__icon">2</div>
                <div class="step__label">TASK 2</div>
            </div>
            <div class="step">
                <div class="step__icon">3</div>
                <div class="step__label">TASK 3</div>
            </div>
            <div class="step">
                <div class="step__icon">4</div>
                <div class="step__label">TASK 4</div>
            </div>
            <div class="step">
                <div class="step__icon">5</div>
                <div class="step__label">TASK 5</div>
            </div>
            <div class="step">
                <div class="step__icon">6</div>
                <div class="step__label">TASK 6</div>
            </div>
            <div class="step">
                <div class="step__icon">END</div>
                <div class="step__label">TASK 7</div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block body%}
<div class="row">
    <div class="col-md-2">
        <ul id="vleft" class="tabs tabs--vertical">
            <li id="vleft-1" class="tab">
                <a tabindex="0" href="/">INSTRUCTIONS</a>
            </li>
            <li id="vleft-2" class="tab">
                <a tabindex="0" href="/task1">TASK 1</a>
            </li>
            <li id="vleft-3" class="tab active">
                <a tabindex="0" href="/task2">TASK 2</a>
            </li>
            <li id="vleft-4" class="tab">
                <a tabindex="0" href="/task3">TASK 3</a>
            </li>
            <li id="vleft-5" class="tab">
                <a tabindex="0" href="/task4">TASK 4</a>
            </li>
            <li id="vleft-6" class="tab">
                <a tabindex="0" href="/task5">TASK 5</a>
            </li>
            <li id="vleft-7" class="tab">
                <a tabindex="0" href="/task6">TASK 6</a>
            </li>
            <li id="vleft-8" class="tab">
                <a tabindex="0" href="/task7">TASK 7</a>
            </li>
            <li id="vleft-9" class="tab">
                <a tabindex="0" href="/task8">TASK 8</a>
            </li>
            <li id="vleft-10" class="tab">
                <a tabindex="0" href="/task9">TASK 9</a>
            </li>
            <li id="vleft-11" class="tab">
                <a tabindex="0" href="/task10">TASK 10</a>
            </li>
            <li id="vleft-12" class="tab">
                <a tabindex="0">SOLUTIONS</a>
            </li>
        </ul>
    </div>
    <div class="col-md-9">
        <div id="vleft-content" class="tab-content">
            <div id="vleft-1-content" class="tab-pane">
                <p>INSTRUCTIONS</p>
            </div>
            <div id="vleft-2-content" class="tab-pane">
                <p>TASK 1</p>
            </div>
            <div id="vleft-3-content" class="tab-pane active">
            </div>
            <div id="vleft-4-content" class="tab-pane">
                <p>TASK 3</p>
            <div id="vleft-5-content" class="tab-pane">
                <p>TASK 4</p>
            <div id="vleft-6-content" class="tab-pane">
                <p>TASK 5</p>
            </div>
            <div id="vleft-7-content" class="tab-pane">
                <p>TASK 6</p>
            </div>
            <div id="vleft-8-content" class="tab-pane">
                <p>SOLUTIONS</p>
            </div>
        </div>
    </div>
</div>
<body class="cui" data-theme="dark">
<h4 class="text-size-28 text-weight-300 panel panel--dark">Clear Identity and Change Token</h4>
    <p class="text-size-18 text-weight-300 base-margin-top text-justify">
    Process for changing account group and clearing identity is:<br>
        1. Stop te-agent services<br>
        2. Edit /etc/te-agent.cfg and change account token<br>
        3. Remove identity database files from /var/lib/te-agent/ <br>
        4. Start services<br>
    </p>
    <p class="text-size-18 text-weight-300 base-margin-top text-justify">
        1. Stop te-agent service
    </p>
    <pre>
        $ sudo systemctl status te-agent
        [sudo] password for tetraining:
        ● te-agent.service - ThousandEyes Agent
             Loaded: loaded (/lib/systemd/system/te-agent.service; enabled; vendor preset: enabled)
             Active: active (running) since Fri 2022-11-25 16:48:53 UTC; 2 days ago
           Main PID: 1156088 (te-agent)
              Tasks: 9 (limit: 9406)
             Memory: 9.7M
             CGroup: /system.slice/te-agent.service
                     └─1156088 /usr/local/bin/te-agent -C /etc/te-agent.cfg

        Nov 25 16:48:53 bootcamp4 systemd[1]: Started ThousandEyes Agent.

        <span class="text-success">$ sudo systemctl stop te-agent</span>

        $ sudo systemctl status te-agent
        ● te-agent.service - ThousandEyes Agent
             Loaded: loaded (/lib/systemd/system/te-agent.service; enabled; vendor preset: enabled)
             Active: inactive (dead) since Mon 2022-11-28 08:06:53 UTC; 15s ago
            Process: 1156088 ExecStart=/usr/local/bin/te-agent -C /etc/te-agent.cfg (code=killed, signal=TERM)
           Main PID: 1156088 (code=killed, signal=TERM)

        Nov 25 16:48:53 bootcamp4 systemd[1]: Started ThousandEyes Agent.
        Nov 28 08:06:53 bootcamp4 systemd[1]: Stopping ThousandEyes Agent...
        Nov 28 08:06:53 bootcamp4 systemd[1]: te-agent.service: Succeeded.
        Nov 28 08:06:53 bootcamp4 systemd[1]: Stopped ThousandEyes Agent.
    </pre>
    <p class="text-size-18 text-weight-300 base-margin-top text-justify">2. Edit /etc/te-agent.cfg and change account group</p>
    <pre>
        log-path=/var/log
        log-file-size=10
        log-level=DEBUG
        num-log-files=13
        <span class="text-success">account-token=k4qcugs8yvi8bmhulm9fflz4al0kt237</span>
        proxy-type=DIRECT
        proxy-location=
        proxy-user=
        proxy-pass=
        proxy-auth-type=
        proxy-bypass-list=
        kdc-user=
        kdc-pass=
        kdc-realm=
        kdc-host=
        kdc-port=88
        kerberos-whitelist=
        kerberos-rdns=1
        crash-reports=1
    </pre>
    <p class="text-size-18 text-weight-300 base-margin-top text-justify">3. Remove identity database files from /var/lib/te-agent/ </p>
    <pre>
    $ ll /var/lib/te-agent/
    total 22232
    drwxr-xr-x  2 root root     4096 Nov 28 08:06 ./
    drwxr-xr-x 49 root root     4096 Nov 10 14:47 ../
    -rw-r--r--  1 root root    36864 Nov 25 16:48 te-agent-config.sqlite
    -rw-r--r--  1 root root 22716416 Nov 28 08:06 te-agent.sqlite

    $ sudo rm -rf /var/lib/te-agent/te-agent*.sqlite

    $ ll /var/lib/te-agent/
    total 8
    drwxr-xr-x  2 root root 4096 Nov 28 08:12 ./
    drwxr-xr-x 49 root root 4096 Nov 10 14:47 ../

    </pre>
<p class="text-size-18 text-weight-300 base-margin-top text-justify">4. Start services</p>
    <pre>
        $ sudo systemctl start te-agent
        [sudo] password for tetraining:

        $ sudo systemctl status te-agent
        ● te-agent.service - ThousandEyes Agent
             Loaded: loaded (/lib/systemd/system/te-agent.service; enabled; vendor preset: enabled)
             Active: active (running) since Mon 2022-11-28 08:44:59 UTC; 30s ago
           Main PID: 1256188 (te-agent)
              Tasks: 9 (limit: 9406)
             Memory: 4.1M
             CGroup: /system.slice/te-agent.service
                     └─1256188 /usr/local/bin/te-agent -C /etc/te-agent.cfg

        Nov 28 08:44:59 bootcamp4 systemd[1]: Started ThousandEyes Agent.
    </pre>
    <div class="row">
        <div class="col-md-12">
            <button class="btn btn--danger--right" style="float: center"><a style="color: black" href="/task3/">TASK3</a></button>
        </div>
    </div>
    <br>
    <br>
</body>

{% endblock %}